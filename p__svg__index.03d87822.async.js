(self["webpackChunk"]=self["webpackChunk"]||[]).push([[614],{4766:function(e){function t(e,t,n,r,o,i,a){try{var c=e[i](a),l=c.value}catch(s){return void n(s)}c.done?t(l):Promise.resolve(l).then(r,o)}function n(e){return function(){var n=this,r=arguments;return new Promise((function(o,i){var a=e.apply(n,r);function c(e){t(a,o,i,c,l,"next",e)}function l(e){t(a,o,i,c,l,"throw",e)}c(void 0)}))}}e.exports=n},98532:function(){},63625:function(e){e.exports={flex:"flex___18rEB","json-viewer":"json-viewer___67rUi"}},61847:function(e){e.exports={flex:"flex___2QKqS",ocr:"ocr___2MIuv","result-box":"result-box___3Msl3","result-list":"result-list___2Y4Jq","ocr-box":"ocr-box___1P_2r",py:"py___1x9RA","py-checked":"py-checked___20k41"}},46675:function(){},91967:function(e,t,n){"use strict";n.d(t,{JO:function(){return c},he:function(){return g},gb:function(){return l.Z}});var r=n(45976),o=n(85893),i=(0,r.Z)({scriptUrl:"//at.alicdn.com/t/font_2677882_tzcg0p99ksf.js"}),a=e=>{var t={};return e.size&&(t.fontSize=e.size),e.color&&(t.color=e.color),(0,o.jsx)(i,{type:"icon-".concat(e.type),style:t})},c=a,l=n(25744),s=n(94184),u=n.n(s),d=n(63625),p=n.n(d),f=e=>{var t=e.json,n=e.text,r=u()(p()["json-viewer"]);return n?(0,o.jsx)("pre",{className:r,children:n}):t?(0,o.jsx)("pre",{className:r,children:JSON.stringify(t,null,2)}):(console.warn("[ JSON Viewer ] == 'json' shouldn't be null, expected Object or Array"),null)},g=f,v=n(32101),m=n(45697),h=n.n(m),y=n(98532),x=n.n(y),b=()=>{},w=e=>{e.name;var t=e.key,n=e.isDragging,r=e.connectDragSource,i=(e.element,n?.4:1),a=u()(x().tag);return r((0,o.jsx)("div",{className:a,style:{opacity:i},children:e.children},t))},_=e=>{var t="box",n={beginDrag:e.begin,endDrag:e.end||b,canDrag:e.canDrag||b,isDragging:e.isDragging||b},r=(e,t)=>({connectDragSource:e.dragSource(),isDragging:t.isDragging()});return(0,v.E)(t,n,r)(w)};_.prototype={begin:h().func.isRequired,end:h().func,canDrag:h().func,isDragging:h().func,element:h().element};var j=n(69684),S=e=>{e.canDrop;var t=e.isOver,n=(e.allowedDropEffect,e.connectDropTarget),r=e.element;console.log("isOVer == ",t);var i=u()({[x()["drag-to"]]:t});return n((0,o.jsx)("div",{className:i,children:r}))},Z=e=>{var t="box",n={drop:e.drop,hover:e.hover,canDrop:e.canDrop},r=(e,t)=>({connectDropTarget:e.dropTarget(),isOver:t.isOver(),canDrop:t.canDrop()});return(0,j.G)(t,n,r)((0,o.jsx)(S,{element:e.element}))};Z.prototype={drop:h().func.isRequired,hover:h().func,canDrag:h().func}},55873:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return N}});n(49111);var r,o=n(19650),i=(n(57663),n(60404)),a=n(3182),c=n(8870),l=n(57337),s=n(94043),u=n.n(s),d=n(29323),p=n(74806),f=n(61847),g=n.n(f),v=n(67294),m=n(91967),h=n(95909),y=n.n(h),x=new Uint8Array(16);function b(){if(!r&&(r="undefined"!==typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!==typeof msCrypto&&"function"===typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto),!r))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return r(x)}var w=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function _(e){return"string"===typeof e&&w.test(e)}for(var j=_,S=[],Z=0;Z<256;++Z)S.push((Z+256).toString(16).substr(1));function D(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(S[e[t+0]]+S[e[t+1]]+S[e[t+2]]+S[e[t+3]]+"-"+S[e[t+4]]+S[e[t+5]]+"-"+S[e[t+6]]+S[e[t+7]]+"-"+S[e[t+8]]+S[e[t+9]]+"-"+S[e[t+10]]+S[e[t+11]]+S[e[t+12]]+S[e[t+13]]+S[e[t+14]]+S[e[t+15]]).toLowerCase();if(!j(n))throw TypeError("Stringified UUID is invalid");return n}var C=D;function k(e,t,n){e=e||{};var r=e.random||(e.rng||b)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var o=0;o<16;++o)t[n+o]=r[o];return t}return C(r)}var z=k,O=n(85893),E=(0,d.Pi)((e=>{var t=(0,v.useState)({}),n=(0,l.Z)(t,2),r=n[0],s=n[1],d=(0,v.useState)(void 0),p=(0,l.Z)(d,2),f=p[0],h=p[1],x=(0,v.useState)(!1),b=(0,l.Z)(x,2),w=b[0],_=b[1],j=(0,v.useState)(!1),S=(0,l.Z)(j,2),Z=S[0],D=S[1],C=(0,v.useState)(null),k=(0,l.Z)(C,2),E=(k[0],k[1]),N=(0,v.useState)([]),R=(0,l.Z)(N,2),P=R[0],T=R[1],G=(0,v.useState)({}),I=(0,l.Z)(G,2),U=I[0],V=I[1],B=(0,v.useRef)(),A=(0,v.useRef)(),J=((0,v.useRef)(),(0,v.useRef)());function L(){var e=B.current.getBoundingClientRect(),t=B.current.getClientRects();console.log("bound == ",e),console.log("rect == ",t),E(e),s({zIndex:99,width:e.width,height:e.height}),F(e)}function q(){P.map((e=>{e.checked=!Z})),D(!Z),T(P)}function F(e){var t=U.rotated_image_width/e.width;console.log("rate == ",t);var n=[];U.lines.map((e=>{n.push({text:e.text,polygons:e.position})})),console.log("data before == ",n);var r=[];n.map((e=>{var n=[];e.polygons.map((e=>{n.push(e/t)}));var o=(0,c.Z)({},e);o.id=z(),o.checked=!1,o.text=e.text,o.polygons=e.polygons,o.polygonsScale=[...n],o.polygonsText="".concat(n[0]," ").concat(n[1],", ").concat(n[2]," ").concat(n[3],", ").concat(n[4]," ").concat(n[5],", ").concat(n[6]," ").concat(n[7]),r.push(o)})),console.log("data after == ",r),T(r)}function M(e){return K.apply(this,arguments)}function K(){return K=(0,a.Z)(u().mark((function e(t){var n,r,o,i,a,c;return u().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.target.files[0],_(!0),e.next=4,y()({fileData:t.target.files[0]});case 4:for(n=e.sent,_(!1),console.log("ocr res == ",n),V(null===n||void 0===n?void 0:n.result),r=[...t.target.files],o=0;o<r.length;o++)i=r[o],a=new Blob([i],{type:i.type}),c=URL.createObjectURL(a),h(c);case 10:case"end":return e.stop()}}),e)}))),K.apply(this,arguments)}function H(e){var t=[...P],n=t.find((t=>t.id===e.id));n.checked=!n.checked,T([...t])}return console.log("data render == ",P,null===P||void 0===P?void 0:P.filter((e=>e.checked))),(0,O.jsxs)(o.Z,{direction:"vertical",style:{width:"100%"},children:[w?(0,O.jsx)(m.gb,{tip:"\u4e0a\u4f20\u8bc6\u522b\u4e2d..."}):null,(0,O.jsxs)("div",{className:g().ocr,children:[(0,O.jsxs)("div",{className:g()["result-box"],children:[(0,O.jsxs)("div",{children:[(0,O.jsx)(i.Z,{type:"primary",onClick:q,children:"\u5168\u9009"}),f?(0,O.jsx)("input",{type:"file",multiple:"multiple",accept:"image/jpeg,image/jpg,image/png,image/gif",ref:A,onChange:M}):null]}),(0,O.jsx)("div",{className:g()["result-list"],children:null===P||void 0===P?void 0:P.filter((e=>e.checked)).map((e=>(0,O.jsx)("div",{children:e.text},e.id)))})]}),(0,O.jsxs)("div",{className:g()["ocr-box"],children:[f?(0,O.jsx)("img",{src:f,ref:B,onLoad:L}):(0,O.jsx)("input",{type:"file",multiple:"multiple",accept:"image/jpeg,image/jpg,image/png,image/gif",ref:A,onChange:M}),(0,O.jsx)("svg",{ref:J,style:r,children:null===P||void 0===P?void 0:P.map((e=>(0,O.jsx)("polygon",{"data-text":e.text,points:e.polygonsText,className:e.checked?"".concat(g().py," ").concat(g()["py-checked"]):g().py,onClick:()=>H(e)},e.id)))})]})]})]})})),N=(0,d.f3)("global","intls","lcStore")((0,p.ZP)(E))},95909:function(e,t,n){var r=n(94043),o=n(4766);e.exports=function(){var e=o(r.mark((function e(t){var n,o,i,a,c,l,s;return r.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.accessKey,o=void 0===n?"78baf470be345366bd85b8f9b18bee80":n,i=t.secretKey,a=void 0===i?"a282de559d6f22d8c49555010f9b98e6":i,c=t.fileData,l=new Headers,l.append("x-ti-app-id",o),l.append("x-ti-secret-code",a),l.append("Content-Type","application/octet-stream"),l.append("Cookie","acw_tc=781bad2416460268990603813e10610a6954922acc26b4385c2bc42b13a48c"),s={method:"POST",headers:l,body:c,redirect:"follow"},e.abrupt("return",new Promise(((e,t)=>{fetch("https://api.textin.com/robot/v1.0/api/text_recognize_3d1?format_whole_text=1",s).then((e=>e.text())).then((n=>{var r=JSON.parse(n);console.log("fetch ocr data == ",r),200===(null===r||void 0===r?void 0:r.code)?e(r):(console.error("fetch ocr error == ",r),t(r)),e(r)})).catch((e=>{console.log("error",e),t(e)}))})));case 8:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},33732:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r,o=n(28481),i=n(67294),a=n(98924),c=function(){return(0,a.Z)()&&window.document.documentElement},l=function(){if(!c())return!1;if(void 0!==r)return r;var e=document.createElement("div");return e.style.display="flex",e.style.flexDirection="column",e.style.rowGap="1px",e.appendChild(document.createElement("div")),e.appendChild(document.createElement("div")),document.body.appendChild(e),r=1===e.scrollHeight,document.body.removeChild(e),r},s=function(){var e=i.useState(!1),t=(0,o.Z)(e,2),n=t[0],r=t[1];return i.useEffect((function(){r(l())}),[]),n}},19650:function(e,t,n){"use strict";n.d(t,{u:function(){return g},Z:function(){return y}});var r=n(22122),o=n(96156),i=n(28481),a=n(67294),c=n(94184),l=n.n(c),s=n(50344),u=n(86032);function d(e){var t=e.className,n=e.direction,i=e.index,c=e.marginDirection,l=e.children,s=e.split,u=e.wrap,d=a.useContext(g),p=d.horizontalSize,f=d.verticalSize,v=d.latestIndex,m=d.supportFlexGap,h={};return m||("vertical"===n?i<v&&(h={marginBottom:p/(s?2:1)}):h=(0,r.Z)((0,r.Z)({},i<v&&(0,o.Z)({},c,p/(s?2:1))),u&&{paddingBottom:f})),null===l||void 0===l?null:a.createElement(a.Fragment,null,a.createElement("div",{className:t,style:h},l),i<v&&s&&a.createElement("span",{className:"".concat(t,"-split"),style:h},s))}var p=n(33732),f=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n},g=a.createContext({latestIndex:0,horizontalSize:0,verticalSize:0,supportFlexGap:!1}),v={small:8,middle:16,large:24};function m(e){return"string"===typeof e?v[e]:e||0}var h=function(e){var t,n=a.useContext(u.E_),c=n.getPrefixCls,v=n.space,h=n.direction,y=e.size,x=void 0===y?(null===v||void 0===v?void 0:v.size)||"small":y,b=e.align,w=e.className,_=e.children,j=e.direction,S=void 0===j?"horizontal":j,Z=e.prefixCls,D=e.split,C=e.style,k=e.wrap,z=void 0!==k&&k,O=f(e,["size","align","className","children","direction","prefixCls","split","style","wrap"]),E=(0,p.Z)(),N=a.useMemo((function(){return(Array.isArray(x)?x:[x,x]).map((function(e){return m(e)}))}),[x]),R=(0,i.Z)(N,2),P=R[0],T=R[1],G=(0,s.Z)(_,{keepEmpty:!0}),I=void 0===b&&"horizontal"===S?"center":b,U=c("space",Z),V=l()(U,"".concat(U,"-").concat(S),(t={},(0,o.Z)(t,"".concat(U,"-rtl"),"rtl"===h),(0,o.Z)(t,"".concat(U,"-align-").concat(I),I),t),w),B="".concat(U,"-item"),A="rtl"===h?"marginLeft":"marginRight",J=0,L=G.map((function(e,t){return null!==e&&void 0!==e&&(J=t),a.createElement(d,{className:B,key:"".concat(B,"-").concat(t),direction:S,index:t,marginDirection:A,split:D,wrap:z},e)})),q=a.useMemo((function(){return{horizontalSize:P,verticalSize:T,latestIndex:J,supportFlexGap:E}}),[P,T,J,E]);if(0===G.length)return null;var F={};return z&&(F.flexWrap="wrap",E||(F.marginBottom=-T)),E&&(F.columnGap=P,F.rowGap=T),a.createElement("div",(0,r.Z)({className:V,style:(0,r.Z)((0,r.Z)({},F),C)},O),a.createElement(g.Provider,{value:q},L))},y=h},49111:function(e,t,n){"use strict";n(43673),n(46675)}}]);